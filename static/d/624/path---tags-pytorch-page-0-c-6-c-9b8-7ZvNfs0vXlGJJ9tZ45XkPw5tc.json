{"data":{"site":{"siteMetadata":{"title":"Mingjun Zhou's blog","author":"Mingjun Zhou","description":"personal blog"}}},"pageContext":{"posts":[{"internal":{"content":"---\ntitle: \"RNN\"\ndate: \"2018-09-07T10:16:47Z\"\ntags: [\"machine learning\",\"pytorch\", \"rnn\"]\n---\n\nRNN\n\ntodo:\nseq2seq:\nhttps://www.microsoft.com/en-us/cognitive-toolkit/blog/2016/11/sequence-to-sequence-deep-recurrent-neural-networks-in-cntk-part-1/"},"fields":{"slug":"/series/pytorch/rnn/","category":"series"},"frontmatter":{"title":"RNN","date":"2018-09-07T10:16:47Z","tags":["machine learning","pytorch","rnn"],"desc":null}},{"internal":{"content":"---\ntitle: \"pytorch\"\ndate: \"2018-09-07T10:16:47Z\"\ntags: [\"machine learning\",\"pytorch\"]\n---\n\nPytorch"},"fields":{"slug":"/series/pytorch/","category":"series"},"frontmatter":{"title":"pytorch","date":"2018-09-07T10:16:47Z","tags":["machine learning","pytorch"],"desc":null}},{"internal":{"content":"---\ntitle: \"Fundamental\"\ndate: \"2018-09-07T10:16:47Z\"\ntags: [\"machine learning\",\"pytorch\", \"rnn\"]\n---\n\n\n# python3\n\n## star operator\n\n## map zip lambda\n \n## NDArray Indexing\nhttps://docs.scipy.org/doc/numpy/user/basics.indexing.html\n\n\n# pytorch\n\n\n## basic rnn\nRefer to https://pytorch.org/docs/stable/nn.html#lstm\n\nAndrej Karpathyâ€™s diagram shows the different pattern in RNN\n![RNN](./rnn.jpe)\n\nThe following code show the concept about sequence. \ntorch.nn.LSTM can handle the sequence automatically, but we can feed it step-by-step also.  \n\n\n```python\nimport torch\n\ninput_size = 10\nhidden_size = 20\nnum_layers = 1\n\n# model\nmodel = torch.nn.LSTM(input_size, hidden_size, num_layers)\n\n# data\ninput = torch.ones(4, 1, 10)\n\n# option1: sequence\noutput, _ = model(input)\n\n# option2: step by step\ninput_0 = input[0,:,:].view(1,1,10)\ninput_1 = input[1,:,:].view(1,1,10)\ninput_2 = input[2,:,:].view(1,1,10)\ninput_3 = input[3,:,:].view(1,1,10)\n\noutput_0, hidden = model(input_0)\noutput_1, hidden = model(input_1, hidden)\noutput_2, hidden = model(input_2, hidden)\noutput_3, hidden = model(input_3 , hidden)\n\n# compare result\nprint(output)\nprint(output_0, output_1, output_2,output_3)\n\nprint ((output[0]==output_0).sum().item() == hidden_size)\nprint ((output[1]==output_1).sum().item() == hidden_size)\nprint ((output[2]==output_2).sum().item() == hidden_size)\nprint ((output[3]==output_3).sum().item() == hidden_size)\n```\n\n\n## pack pad\n\n\n\nhttps://djosix.github.io/Variable-Sequence-Lengths-for-PyTorch-RNNs/\n\n# refs\n\nhttps://www.pythonlikeyoumeanit.com/intro.html\n https://djosix.github.io/Variable-Sequence-Lengths-for-PyTorch-RNNs/\n https://medium.com/understand-the-python/understanding-the-asterisk-of-python-8b9daaa4a558"},"fields":{"slug":"/series/pytorch/rnn/1-Fundamental/","category":"series"},"frontmatter":{"title":"Fundamental","date":"2018-09-07T10:16:47Z","tags":["machine learning","pytorch","rnn"],"desc":null}}],"tag":"pytorch","pagesSum":1,"page":0}}