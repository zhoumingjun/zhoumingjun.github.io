{"data":{"site":{"siteMetadata":{"title":"Mingjun Zhou's blog","author":"Mingjun Zhou","description":"personal blog"}}},"pageContext":{"posts":[{"internal":{"content":"\n# how to enable mathjax in gatsby\n\n# Steps\n\n## 1. Configure gatsby-config.js\n```\n// In your gatsby-config.js\nplugins: [\n  {\n    resolve: `gatsby-transformer-remark`,\n    options: {\n      plugins: [\n        `gatsby-remark-mathjax`,\n      ],\n    },\n  },\n],\n```\n\n## 2. Customize html.js\nFollows the [official document](https://www.gatsbyjs.org/docs/custom-html/)   \n\nHere is my [html.js](https://github.com/zhoumingjun/zhoumingjun.github.io/blob/source/src/html.js)\n\n```javascript\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nconst MathJaxConfig = `\nwindow.MathJax = {\n  tex2jax: {\n    inlineMath: [['$', '$'] ],\n    displayMath: [['$$', '$$'] ],\n    processEscapes: true,\n    processEnvironments: true,\n    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],\n    TeX: {\n      equationNumbers: {autoNumber: 'AMS'},\n      extensions: ['AMSmath.js', 'AMSsymbols.js', 'color.js'],\n    },\n  }\n};\n`;\n\nexport default class HTML extends React.Component {\n  render() {\n    return (\n      <html {...this.props.htmlAttributes}>\n        <head>\n          <meta charSet=\"utf-8\" />\n          <meta httpEquiv=\"x-ua-compatible\" content=\"ie=edge\" />\n          <meta\n            name=\"viewport\"\n            content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"\n          />\n          {this.props.headComponents}\n        </head>\n        <body {...this.props.bodyAttributes}>\n          {this.props.preBodyComponents}\n          <div\n            key={`body`}\n            id=\"___gatsby\"\n            dangerouslySetInnerHTML={{__html: this.props.body}}\n          />\n          {this.props.postBodyComponents}\n          <script dangerouslySetInnerHTML={{__html: MathJaxConfig}} />\n          <script\n            defer\n            src=\"https://cdn.bootcss.com/mathjax/2.7.4/latest.js?config=TeX-AMS_SVG\"\n          />\n        </body>\n      </html>\n    );\n  }\n}\n\nHTML.propTypes = {\n  htmlAttributes: PropTypes.object,\n  headComponents: PropTypes.array,\n  bodyAttributes: PropTypes.object,\n  preBodyComponents: PropTypes.array,\n  body: PropTypes.string,\n  postBodyComponents: PropTypes.array,\n};\n\n```\n\n## 3. Configure gatsby-browser.js\nMathJax will process all math equations when the location changed.\n\nHere is my [gatsby-brower.js](https://github.com/zhoumingjun/zhoumingjun.github.io/blob/source/gatsby-browser.js)\n\n```\nexports.onRouteUpdate = ({location}) => {\n  console.log('new pathname', location.pathname);\n  if (window.MathJax !== undefined) {\n    MathJax.Hub.Queue(['Typeset', MathJax.Hub]);\n  }\n};\n\n```"},"fields":{"slug":"/post/2018-09-04-enable-mathjax-in-gatsby/","category":"post"},"frontmatter":{"title":"Enable mathjax in gatsby","date":"2018-09-04T06:30:28Z","tags":["gatsby","mathjax"],"desc":"Mathjax was used in some old posts, and it can't work correctly in gastby now. "}}],"tag":"mathjax","pagesSum":1,"page":0}}