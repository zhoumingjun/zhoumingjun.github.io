{"data":{"site":{"siteMetadata":{"title":"Mingjun Zhou's blog","author":"Mingjun Zhou","description":"personal blog"}}},"pageContext":{"outline":"{\"linux\":{\"children\":{\"networking\":{\"children\":{\"basic\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle: 'Basic'\\ndate: '2018-09-03T05:33:48Z'\\n---\\n\\nhttp://linux-ip.net/html/routing-tables.html\\n\\n\\n# ip rule\\n```\\nman ip rule\\nip rule list\\n```\\nSemantically, the natural action is to select the nexthop and the output device.\\n\\nAt startup time the kernel configures the default RPDB consisting of three rules:\\n\\n1.     Priority: 0, Selector: match anything, Action: lookup routing table local (ID 255).  The local table is a\\n        special routing table containing high priority control routes for local and broadcast addresses.\\n\\n2.     Priority: 32766, Selector: match anything, Action: lookup routing table main (ID 254).  The main table is\\n        the normal routing table containing all non-policy routes. This rule may be deleted and/or overridden with\\n        other ones by the administrator.\\n\\n3.     Priority: 32767, Selector: match anything, Action: lookup routing table default (ID 253).  The default table\\n        is empty. It is reserved for some post-processing if no previous default rules selected the packet.  This\\n        rule may also be deleted.\\n\\n# ip route \\ncat /etc/iproute2/rt_tables\\n\\nip -d route show table local\\nip -d route show table main\\n\\n# iptables\\n\\nhttps://www.kernel.org/doc/Documentation/networking/tproxy.txt\\n\\nhttps://n0where.net/how-does-it-work-iptables\\n\\n \\n![iptables Processing Flowchart](https://stuffphilwrites.com/wp-content/uploads/2018/09/FW-IDS-iptables-Flowchart-2018-09-01.png)\\n\\n# TPROXY\\n\\nhttps://github.com/kristrev/tproxy-example\\n\\n# books\\nhttps://blog.csdn.net/freeking101/article/details/71473369\\n首先要说讲述TCP/IP的书很多，其中有3本书很全。\\n\\n分别是《TCP/IP详解》三卷本，《用TCP/IP进行网际互连》三卷本，《TCP/IP指南》+《IPv6》四卷本\\n\\n其中TCP/IP详解的作者还写了另外2本经典著作，《Unix环境高级编程》，《Unix网络编程》\\n\\n作者W.Richard Stevens个人网站  http://www.kohala.com/\\n\\n大师作品部部经典，可惜1999年去另一个世界维护Unix了。。。。。。。。。\"},\"fields\":{\"slug\":\"/knowledgebase/linux/networking/basic/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"Basic\",\"date\":\"2018-09-03T05:33:48Z\",\"tags\":null,\"desc\":null}}},\"proxy\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle: 'proxy'\\ndate: '2018-09-03T02:47:42Z'\\n---\\n\\n\\nclient:\\n```bash\\nip route del default via <old_gateway>\\nip route add default via <new_gateway>\\n\\n```\\n\\nserver\\n```bash\\n#1 enable ip forward\\nsysctl -w net.ipv4.ip_forward=1\\n\\n\\nnet.ipv4.ip_forward = 0\\nsysctl -p /etc/sysctl.conf \\n\\n\\n# marking non-local sockets work \\niptables -t mangle -N DIVERT\\niptables -t mangle -A PREROUTING -p tcp -m socket -j DIVERT\\niptables -t mangle -A DIVERT -j MARK --set-mark 0x1/0x1\\niptables -t mangle -A DIVERT -j ACCEPT\\n\\nip rule add fwmark 1 lookup 100\\nip route add local 0.0.0.0/0 dev lo table 100\\n\\n\\niptables -t mangle -A PREROUTING -p tcp -d 1.2.3.4 -j TPROXY --tproxy-mark 0x1/0x1 --on-port 50080\\niptables -t mangle -A PREROUTING -p udp -d 1.2.3.4 -j TPROXY --tproxy-mark 0x1/0x1 --on-port 50080\\n\\n\\n```\\n\\n\\ntsocket\\nTransparent Proxying Patches, Take 3\\nhttps://lwn.net/Articles/252545/\\n\\nsquid\\nhttps://wiki.squid-cache.org/Features/Tproxy4\\n\"},\"fields\":{\"slug\":\"/knowledgebase/linux/networking/proxy/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"proxy\",\"date\":\"2018-09-03T02:47:42Z\",\"tags\":null,\"desc\":null}}},\"refs\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle: 'references'\\ndate: '2018-08-31T10:45:20Z'\\n---\\n\\nref: https://gist.github.com/fffaraz/2b86cf1f1a1f9564c51b\\n\\nWeb Resources\\n=============\\n\\n#### Course Textbooks\\n\\n-   [Tim Jones homepage](http://www.mtjones.com/) (author of primary textbook, note that book code is only on cdrom with book)\\n-   [*GNU/Linux Application Programming (1st ed.)* by Tim Jones](http://books.google.com/books?id=KjEq9Mua5TQC&dq=gnu+linux+application+programming&printsec=frontcover&source=bn&hl=en&ei=wwxmSv-yLpW0NpXLwZYB&sa=X&oi=book_result&ct=result&resnum=4) (much of first edition of Jones text on Google Books)\\n-   [*Beginning Linux Programming (4th ed.)* by Matthew and Stones](http://www.wrox.com/WileyCDA/WroxTitle/Beginning-Linux-Programming-4th-Edition.productCd-0470147628.html) (alternative text, can download code from this site)\\n-   [free download of *Beginning Linux Programming (4th ed.)*](http://www.ebooksdownloadfree.com/Linux-Unix/Beginning-Linux-Programming-4th-Edition-BI750.html)\\n\\n#### Other Linux/UNIX Programming Books (w/code)\\n\\n-   [*The Linux Programming Interface* by Kerrisk](http://man7.org/tlpi/)\\n-   [*Linux Application Development (2nd ed)* by Johnson and Troan](http://www.ladweb.net/)\\n-   [*Advanced Linux Programming*](http://www.advancedlinuxprogramming.com/) (free online ebook)\\n-   [*Understanding Unix/Linux Programming* by Molay](http://wps.prenhall.com/esm_molay_UNIXProg_1/0,6678,522376-,00.html)\\n-   [*Advanced UNIX Programming* by Rochkind](http://www.basepath.com/aup/)\\n-   [*Advanced Programming in the UNIX Environment*, 2ed, by Stevens and Rago](http://www.apuebook.com/)\\n-   [*UNIX Network Programming* Vol 1, 2ed, by Stevens](http://www.kohala.com/start/unpv12e.html)\\n-   [*UNIX Network Programming* Vol 2, 2ed, by Stevens](http://www.kohala.com/start/unpv22e/unpv22e.html)\\n\\n#### Linux Documentation and General Info/Help\\n\\n-   [Linux Documentation Project (HowTo's, etc.)](http://www.tldp.org)\\n-   [Introduction to Linux (Guide)](http://www.tldp.org/LDP/intro-linux/html/index.html)\\n-   [Bash Guide for Beginners](http://www.tldp.org/LDP/Bash-Beginners-Guide/html/index.html)\\n-   [Linux Command-Line Tools Summary](http://www.tldp.org/LDP/GNU-Linux-Tools-Summary/html/index.html)\\n-   [The Linux System Administrator's Guide](http://www.tldp.org/LDP/sag/html/index.html)\\n-   [LinuxQuestions.org](http://www.linuxquestions.org)\\n-   [Linuxhelp.net](http://www.linuxhelp.net)\\n-   [Rute User's Tutorial (online/downloadable admin book)](http://www.icon.co.za/~psheer/book/rute.html.gz)\\n-   [Linux Program Library HowTo](http://www.dwheeler.com/program-library/Program-Library-HOWTO/index.html)\\n-   [Secure Programming for Linux HowTo](http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/index.html)\\n\\n#### Bash (shell)\\n\\n-   [Bash home](http://www.gnu.org/software/bash/bash.html)\\n-   [Bash Reference Manual](http://www.gnu.org/software/bash/manual/bash.html)\\n-   [BASH Programming - Introduction HOW-TO](http://en.tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html)\\n-   [Advanced Bash-Scripting Guide](http://en.tldp.org/LDP/abs/html/index.html)\\n-   [Bash Programming Cheat Sheet](http://www.justlinux.com/nhf/Programming/Bash_Programming_Cheat_Sheet.html)\\n-   [Introduction to Bash Shell Scripting](http://www.justlinux.com/nhf/Programming/Introduction_to_bash_Shell_Scripting.html)\\n-   [IBM: Bash by example, Part 1/3](http://www.ibm.com/developerworks/library/l-bash.html)\\n-   [IBM: Bash by example, Part 2/3](http://www.ibm.com/developerworks/library/l-bash2.html)\\n-   [IBM: Bash by example, Part 3/3](http://www.ibm.com/developerworks/library/l-bash3.html)\\n\\n#### Emacs (extensible/customizable editor)\\n\\n-   [GNU Emacs home](http://www.gnu.org/software/emacs/emacs.html)\\n-   [GNU Emacs manuals](http://www.gnu.org/software/emacs/manual/)\\n-   [XEmacs home](http://www.xemacs.org/)\\n-   [EmacsWiki (help materials)](http://www.emacswiki.org/cgi-bin/wiki)\\n-   [Emacs Wikipedia entry](http://en.wikipedia.org/wiki/Emacs)\\n\\n#### Vi/Vim (editor)\\n\\n-   [Vi lovers home](http://www.thomer.com/thomer/vi/vi.html)\\n-   [Vim home](http://www.vim.org/)\\n-   [Introduction to Programming in C/C++ with Vim](http://www.justlinux.com/nhf/Programming/Introduction_to_C_Programming.html)\\n-   [Vi Wikipedia entry](http://en.wikipedia.org/wiki/Vi)\\n\\n#### C Language Reference Cards and Overviews\\n\\n-   [ANSI C Reference Card v2.2 (PDF)](http://math.brown.edu/~jhs/ReferenceCards/CRefCard.v2.2.pdf)\\n\\n#### C Language Reference Material\\n\\n-   [C Overview (Wikipedia)](http://en.wikipedia.org/wiki/C_(programming_language))\\n-   [C Syntax (Wikipedia)](http://en.wikipedia.org/wiki/C_syntax)\\n-   [C Variable Types (Wikipedia)](http://en.wikipedia.org/wiki/C_variable_types_and_declarations)\\n-   [Operators in C/C++ (Wikipedia)](http://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B)\\n-   [C Strings (Wikipedia)](http://en.wikipedia.org/wiki/C_string)\\n-   [C Standard Library (Wikipedia)](http://en.wikipedia.org/wiki/C_standard_library)\\n-   [C Library Functions (Wikipedia)](http://en.wikipedia.org/wiki/List_of_C_functions)\\n-   [C99 (and beyond) Draft Standard](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)\\n-   [C Language FAQ (comp.lang.c newsgroup)](http://c-faq.com/)\\n-   [The New C Standard (1600 page downloadable book covering C standards)](http://www.knosof.co.uk/cbook/)\\n-   [The Inquirer article on above book](http://www.theinquirer.net/inquirer/news/1016493/the-new-c-standard-free-ebook-c-coders)\\n-   [The C Library Reference Guide](http://www.acm.uiuc.edu/webmonkeys/book/c_guide/)\\n-   [CERT C Secure Coding Standard](https://www.securecoding.cert.org/confluence/display/seccode/CERT+C+Secure+Coding+Standard)\\n\\n#### C Language Help/Tutorials\\n\\n-   [The C Book (free online version of out-of-print book)](http://publications.gbdirect.co.uk/c_book/)\\n-   [The C Cheat Sheet (PDF)](http://claymore.engineer.gvsu.edu/~steriana/226/C.CheatSheet.pdf)[overview of C]\\n-   [CProgramming.com, C/C++ programming help site](http://www.cprogramming.com/)\\n-   [C Programming Tutorial](http://randu.org/tutorials/c/)\\n-   [C Language Tutorial](http://www.physics.drexel.edu/courses/Comp_Phys/General/C_basics/c_tutorial.html)\\n-   [C Programming](http://www.its.strath.ac.uk/courses/c/)\\n-   [How C Programming Works](http://computer.howstuffworks.com/c.htm)\\n-   [C++ Memory Management](http://linux.oreillynet.com/pub/a/linux/2003/05/08/cpp_mm-1.html) (many of the problems apply to C as well)\\n-   [Steve Summit's C Programming Notes (set 1)](http://www.eskimo.com/~scs/cclass/notes/top.html)\\n-   [Steve Summit's C Programming Notes (set 2)](http://www.eskimo.com/~scs/cclass/int/top.html)\\n-   [Exforsys Inc C Language Tutorials](http://www.exforsys.com/tutorials/c-language.html)\\n\\n#### C Language Books\\n\\n-   [The C Book (free online version of out-of-print book)](http://publications.gbdirect.co.uk/c_book/)\\n-   [An Introduction to the C Programming Language and Software Design (Bailey)](http://www-personal.acfr.usyd.edu.au/tbailey/ctext/)\\n-   [C Programming (Wikibooks)](http://en.wikibooks.org/wiki/C_Programming)\\n-   [C Programming Tutorial (Burgess)>/a>](http://markburgess.org/CTutorial/C-Tut-4.02.pdf)\\n-   [Beginning C (Horton)](http://www.codewithc.com/beginning-c-ivor-horton-pdf-download-4th-edition/)\\n-   [Expert C Programming (van der Linden)](http://www.e-reading.me/bookreader.php/138815/Linden_-_Expert_C_Programming__Deep_C_Secrets.pdf)\\n\\n#### Linux & C Development Tutorials/Info\\n\\n-   [The Linux Development Platform (book, online html version)](http://www.faqs.org/docs/ldev/)\\n-   [Software Optimization Resources](http://www.agner.org/optimize/)\\n\\n#### C Indentation Tools\\n\\n-   [Wikipedia: Indent Style](http://en.wikipedia.org/wiki/Indent_style)\\n-   [GNU Indent](http://www.gnu.org/s/indent/)\\n-   [Uncrustify](http://uncrustify.sourceforge.net/)\\n-   [Emacs Wiki: Indenting C](http://www.emacswiki.org/emacs/IndentingC)\\n-   [Brace and Indent Styles](http://www.riedquat.de/prog/style)\\n-   [UniversalIndentGUI](http://universalindent.sourceforge.net/)\\n\\n#### GNU C/C++ Tools\\n\\n-   [GCC (GNU Compiler Collection) home](http://gcc.gnu.org/)\\n-   [GCC manuals](http://gcc.gnu.org/onlinedocs/)\\n-   [An Introduction to GCC (book, with online HTML version)](http://www.network-theory.co.uk/docs/gccintro)\\n-   [The GNU C Library manuals](http://www.gnu.org/software/libc/manual/)\\n-   [GDB (GNU Debugger) home](http://www.gnu.org/software/gdb/)\\n-   [GDB manual](http://www.gnu.org/software/gdb/documentation)\\n-   [DDD (GNU Data Display Debugger) home](http://www.gnu.org/software/ddd/)\\n-   [DDD manual](http://www.gnu.org/manual/ddd/)\\n-   [Make home](http://www.gnu.org/software/make/)\\n-   [Make manual](http://www.gnu.org/manual/make/)\\n-   [Comparing and Merging Files with GNU diff and patch (book, with online HTML version)](http://www.network-theory.co.uk/docs/diff)\\n-   [ACM Developing Software in UNIX Tutorial](http://www.cs.washington.edu/orgs/acm/tutorials/dev-in-unix/)\\n\\n#### Eclispse IDE\\n\\n-   [Eclipse (main webpage)](http://www.eclipse.org)\\n-   [Eclipse CDT (C/C++ Development Tooling)](http://www.eclipse.org/cdt)\\n-   [Using Eclipse for C/C++ Programming](http://www.math.ucla.edu/~anderson/UsingEclipseCPP/index.html)\\n-   [Remote C Development Using Eclipse](http://www.madirish.net/190)\\n\\n#### Netbeans IDE\\n\\n-   [Netbeans (main webpage)](http://www.netbeans.org)\\n-   [Netbeans C/C++ features](http://www.netbeans.org/features/cpp)\\n-   [Netbeans C/C++ tutorial](http://www.netbeans.org/kb/trails/cnd.html)\\n-   [Getting Started With the NetBeans C/C++ Development Pack](http://cnd.netbeans.org/cnd-tutorial.html)\\n\\n#### Other C/C++ Editors and IDEs for Linux\\n\\n-   [Geany editor/IDE](http://www.geany.org/)\\n-   [Kdevelop (KDE IDE)](http://www.kdevelop.org)\\n-   [Anjuta IDE for GNOME](http://projects.gnome.org/anjuta/)\\n-   [CodeLite IDE](http://codelite.org/)\\n-   [jEdit](http://www.jedit.org/)\\n\\n#### Programming Analysis Tools for C/C++\\n\\n-   [Valgrind (memory management debugging and profiling for x86-Linux programs)](http://valgrind.kde.org)\\n-   [Splint (Secure Programming Lint -- supersedes LCLint)](http://www.splint.org)\\n-   [strace, ltrace tutorial](http://doc.opensuse.org/documentation/html/openSUSE/opensuse-tuning/cha.tuning.tracing.html)\\n\\n#### SSH/SFTP/SCP Software for Windows\\n\\n-   [PuTTY and PSFTP (SSH terminal and command-line transfer)](http://www.chiark.greenend.org.uk/~sgtatham/putty/)\\n-   [WinSCP (GUI secure copy/sftp software)](http://winscp.sourceforge.net/eng/index.php)\\n\\n#### Linux Distributions (selective)\\n\\n-   [CentOS (free Redhat clone)](http://fedora.centos.org)\\n-   [Fedora (free Redhat project)](http://fedora.redhat.com)\\n-   [Knoppix (Linux on a CD)](http://www.knoppix.org)\\n-   [Kubuntu (KDE-based Ubuntu distro)](http://www.kubuntu.org)\\n-   [Mageia (community Mandriva fork)](http://www.mageia.org)\\n-   [Redhat](http://www.redhat.com)\\n-   [Mint](http://www.linuxmint.com)\\n-   [Suse (OpenSuse)](http://en.opensuse.org)\\n-   [Ubuntu](http://www.ubuntu.com)\\n\\n#### Linux Distributions Info Sites\\n\\n-   [DistroWatch.com](http://www.distrowatch.com)\\n-   [LiveCD Linux List](http://www.livecdlist.com)\\n\\n#### Free Virtualization Software and Info\\n\\n-   [VirtualBox](http://www.virtualbox.org/)\\n-   [VMWare](http://www.vmware.com/)\\n-   [Installing Ubuntu in VirtualBox on Windoze](http://www.howtoforge.com/virtualbox_ubuntu)\\n-   [Installing Ubuntu in VirtualBox on Windoze](http://www.simplehelp.net/2007/05/13/how-to-install-ubuntu-studio-in-windows-using-virtualbox-a-complete-walkthrough/)\"},\"fields\":{\"slug\":\"/knowledgebase/linux/networking/refs/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"references\",\"date\":\"2018-08-31T10:45:20Z\",\"tags\":null,\"desc\":null}}},\"veth\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle: 'veth'\\ndate: '2018-08-31T10:45:20Z'\\n---\\n\\n\\nhttps://gabhijit.github.io/linux-virtual-interfaces.html\\n\\n\"},\"fields\":{\"slug\":\"/knowledgebase/linux/networking/veth/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"veth\",\"date\":\"2018-08-31T10:45:20Z\",\"tags\":null,\"desc\":null}}}},\"post\":{\"internal\":{\"content\":\"---\\ntitle : \\\"networking\\\"\\ndate: '2018-08-31T10:45:20Z'\\ntags : ['misc', 'network']\\n---\\nhttps://www.slideshare.net/ThomasGraf5/linux-networking-explained\\n\\ndocker network\\n\\nhttps://success.docker.com/article/networking\"},\"fields\":{\"slug\":\"/knowledgebase/linux/networking/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"networking\",\"date\":\"2018-08-31T10:45:20Z\",\"tags\":[\"misc\",\"network\"],\"desc\":null}}},\"namespace\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle : \\\"namespace\\\"\\ndate : \\\"2017-03-06T16:03:35+08:00\\\"\\ntags : ['misc']\\n---\\nhttps://medium.com/@teddyking/namespaces-in-go-basics-e3f0fc1ff69a\\n\\n\\n* view docker container's namespace \\n\\n```bash\\npid=`docker inspect -f '{{.State.Pid}}' $container_id`\\nln -s /proc/$pid/ns/net /var/run/netns/$container_id\\n```\"},\"fields\":{\"slug\":\"/knowledgebase/linux/namespace/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"namespace\",\"date\":\"2017-03-06T16:03:35+08:00\",\"tags\":[\"misc\"],\"desc\":null}}}},\"post\":{\"internal\":{\"content\":\"---\\ntitle : \\\"linux\\\"\\ndate : \\\"2017-03-06T16:03:35+08:00\\\"\\ntags : ['linux']\\n---\"},\"fields\":{\"slug\":\"/knowledgebase/linux/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"linux\",\"date\":\"2017-03-06T16:03:35+08:00\",\"tags\":[\"linux\"],\"desc\":null}}},\"visualization\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle : \\\"visualization\\\"\\ndate : \\\"2018-08-31T10:44:53Z\\\"\\n---\\n\\nVisualization\"},\"fields\":{\"slug\":\"/knowledgebase/visualization/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"visualization\",\"date\":\"2018-08-31T10:44:53Z\",\"tags\":null,\"desc\":null}},\"children\":{\"docker\":{\"children\":{\"deep\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle : \\\"network in deep\\\"\\ndate : \\\"2017-03-06T16:03:35+08:00\\\"\\n---\\n\\n* docker int details    \\nhttps://docker-k8s-lab.readthedocs.io/en/latest/index.html\\n\\n* Container Namespaces – Deep Dive into Container Networking    \\nhttps://platform9.com/blog/container-namespaces-deep-dive-container-networking/\\n\\n```bash\\ncontainer_name=xxx\\npid=$(docker inspect -f '{{.State.Pid}}' \\\"$container_name\\\")\\nsudo mkdir -p /var/run/netns\\nsudo ln -sf /proc/$pid/ns/net \\\"/var/run/netns/$container_name\\\"\\nsudo ip netns\\nsudo ip netns exec \\\"$container_name\\\" ip a\\n```\\n\\n* netadmin\\nDocker containers do not have full privileges by default. Try adding this to the docker run command:\\n\\n\\n  --cap-add=NET_ADMIN\\n\"},\"fields\":{\"slug\":\"/knowledgebase/visualization/docker/deep/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"network in deep\",\"date\":\"2017-03-06T16:03:35+08:00\",\"tags\":null,\"desc\":null}}}},\"post\":{\"internal\":{\"content\":\"---\\ntitle : \\\"docker\\\"\\ndate : \\\"2017-03-06T16:03:35+08:00\\\"\\ntags : ['linux']\\n---\\n\\nxx\"},\"fields\":{\"slug\":\"/knowledgebase/visualization/docker/\",\"category\":\"knowledgebase\"},\"frontmatter\":{\"title\":\"docker\",\"date\":\"2017-03-06T16:03:35+08:00\",\"tags\":[\"linux\"],\"desc\":null}}}}}}"}}