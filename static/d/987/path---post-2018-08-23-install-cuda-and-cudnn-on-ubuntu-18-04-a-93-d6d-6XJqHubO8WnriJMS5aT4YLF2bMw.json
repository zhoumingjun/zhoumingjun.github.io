{"data":{"site":{"siteMetadata":{"title":"Mingjun Zhou's blog","author":"Mingjun Zhou","sourceUrl":"https://github.com/zhoumingjun/zhoumingjun.github.io/blob/source/","siteUrl":"https://zhoumingjun.github.io","disqusShortname":"zhoumingjun"}},"markdownRemark":{"id":"9572a779-f388-5815-bdcc-1c4d531a2e24 >>> MarkdownRemark","excerpt":"Overview To run tensorflow/pytorch with gpu, I need to install cuda and cudnn.\nIt’s really tricky, but finally I found the method.  The…","html":"<h1>Overview</h1>\n<p>To run tensorflow/pytorch with gpu, I need to install cuda and cudnn.\nIt’s really tricky, but finally I found the method. </p>\n<p>The secret is   </p>\n<ul>\n<li>install the graphics driver from a PPA </li>\n<li>install the toolkit from the run file</li>\n</ul>\n<h1>packages</h1>\n<p>The following packages need to be installed.</p>\n<ul>\n<li>nvidia graphics driver     </li>\n<li>cuda 9.2  </li>\n<li>cudnn 7.2</li>\n</ul>\n<p>For nvidia graphics driver, there are two sources:</p>\n<ol>\n<li>\n<p>raphics-drivers/ppa:<br>\n<a href=\"https://launchpad.net/~graphics-drivers/+archive/ubuntu/ppa\">https://launchpad.net/~graphics-drivers/+archive/ubuntu/ppa</a><br>\nthe package is nvidia-driver-396</p>\n</li>\n<li>\n<p>nvidia official repo\n<a href=\"https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1710/x86_64/cuda-drivers_396.44-1_amd64.deb\">https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1710/x86<em>64/cuda-drivers</em>396.44-1_amd64.deb</a><br>\nthe package is cuda-drivers</p>\n</li>\n</ol>\n<p>In fact the nvidia cuda-drivers is for ubuntu 17.10, and there are no official nvidia repo for ubuntu 18.04 currently.<br>\nHere we need to select option 1, I have try option2, but there are conflict with other packages.<br>\nI install the cuda-drivers with “—force-overwrite”, but gdm can’t be launched normally.</p>\n<p>For cuda 9.2, it can be download directly from nvidia website.</p>\n<p>For cudnn7.2, <strong>it can be download from nvidia machine-learning repo without login</strong></p>\n<h1>installation steps</h1>\n<p>install nvidia graphics driver  </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> add-apt-repository ppa:graphics-drivers/ppa\n<span class=\"token function\">sudo</span> apt update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> nvidia-driver-396</code></pre></div>\n<p>install cuda    </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># dowload installer</span>\naria2c https://developer.nvidia.com/compute/cuda/9.2/Prod2/local_installers/cuda_9.2.148_396.37_linux \n\naria2c https://developer.nvidia.com/compute/cuda/9.2/Prod2/patches/1/cuda_9.2.148.1_linux  \n\n<span class=\"token comment\"># install cuda9.2 and patch</span>\n<span class=\"token function\">chmod</span> +x cuda*\n\n<span class=\"token function\">sudo</span> ./cuda_9.2.148_396.37_linux.run --verbose --silent --toolkit --override\n\n<span class=\"token function\">sudo</span> ./cuda_9.2.148.1_linux.run --silent --accept-eula\n\n<span class=\"token comment\"># add to ld</span>\n<span class=\"token function\">sudo</span> <span class=\"token keyword\">echo</span> <span class=\"token string\">\"/usr/local/cuda-9.2/lib64\"</span> <span class=\"token operator\">>></span> /etc/ld.so.conf\n<span class=\"token function\">sudo</span> ldconfig</code></pre></div>\n<p>install cudnn   </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">#download packages</span>\naria2c https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64/libcudnn7_7.2.1.38-1+cuda9.2_amd64.deb\n\naria2c https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64/libcudnn7-dev_7.2.1.38-1+cuda9.2_amd64.deb    \n\n<span class=\"token comment\"># install</span>\n<span class=\"token function\">sudo</span> dpkg -i libcudnn7_7.2.1.38-1+cuda9.2_amd64.deb\n<span class=\"token function\">sudo</span> dpkg -i libcudnn7-dev_7.2.1.38-1+cuda9.2_amd64.deb</code></pre></div>","fileAbsolutePath":"/home/zhoumingjun/github.com/zhoumingjun/zhoumingjun.github.io/content/post/2018-08-23-install-cuda-and-cudnn-on-ubuntu18.04/index.md","fields":{"slug":"/post/2018-08-23-install-cuda-and-cudnn-on-ubuntu18.04/","category":"post"},"frontmatter":{"title":"Install cuda9.2 and cudnn7.2 on ubuntu 18.04","date":"August 23, 2018"}}},"pageContext":{"slug":"/post/2018-08-23-install-cuda-and-cudnn-on-ubuntu18.04/","prev":{"internal":{"content":"---\ntitle : \"Enable mathjax in gatsby\"\ndate : \"2018-09-04T06:30:28Z\"\ntags : [\"gatsby\", \"mathjax\"]\ndesc: \"Mathjax was used in some old posts, and it can't work correctly in gastby now. \"\n---\n\n# how to enable mathjax in gatsby\n\n# Steps\n\n## 1. Configure gatsby-config.js\n```\n// In your gatsby-config.js\nplugins: [\n  {\n    resolve: `gatsby-transformer-remark`,\n    options: {\n      plugins: [\n        `gatsby-remark-mathjax`,\n      ],\n    },\n  },\n],\n```\n\n## 2. Customize html.js\nFollows the [official document](https://www.gatsbyjs.org/docs/custom-html/)   \n\nHere is my [html.js](https://github.com/zhoumingjun/zhoumingjun.github.io/blob/source/src/html.js)\n\n```javascript\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nconst MathJaxConfig = `\nwindow.MathJax = {\n  tex2jax: {\n    inlineMath: [['$', '$'] ],\n    displayMath: [['$$', '$$'] ],\n    processEscapes: true,\n    processEnvironments: true,\n    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],\n    TeX: {\n      equationNumbers: {autoNumber: 'AMS'},\n      extensions: ['AMSmath.js', 'AMSsymbols.js', 'color.js'],\n    },\n  }\n};\n`;\n\nexport default class HTML extends React.Component {\n  render() {\n    return (\n      <html {...this.props.htmlAttributes}>\n        <head>\n          <meta charSet=\"utf-8\" />\n          <meta httpEquiv=\"x-ua-compatible\" content=\"ie=edge\" />\n          <meta\n            name=\"viewport\"\n            content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"\n          />\n          {this.props.headComponents}\n        </head>\n        <body {...this.props.bodyAttributes}>\n          {this.props.preBodyComponents}\n          <div\n            key={`body`}\n            id=\"___gatsby\"\n            dangerouslySetInnerHTML={{__html: this.props.body}}\n          />\n          {this.props.postBodyComponents}\n          <script dangerouslySetInnerHTML={{__html: MathJaxConfig}} />\n          <script\n            defer\n            src=\"https://cdn.bootcss.com/mathjax/2.7.4/latest.js?config=TeX-AMS_SVG\"\n          />\n        </body>\n      </html>\n    );\n  }\n}\n\nHTML.propTypes = {\n  htmlAttributes: PropTypes.object,\n  headComponents: PropTypes.array,\n  bodyAttributes: PropTypes.object,\n  preBodyComponents: PropTypes.array,\n  body: PropTypes.string,\n  postBodyComponents: PropTypes.array,\n};\n\n```\n\n## 3. Configure gatsby-browser.js\nMathJax will process all math equations when the location changed.\n\nHere is my [gatsby-brower.js](https://github.com/zhoumingjun/zhoumingjun.github.io/blob/source/gatsby-browser.js)\n\n```\nexports.onRouteUpdate = ({location}) => {\n  console.log('new pathname', location.pathname);\n  if (window.MathJax !== undefined) {\n    MathJax.Hub.Queue(['Typeset', MathJax.Hub]);\n  }\n};\n\n```"},"fields":{"slug":"/post/2018-09-04-enable-mathjax-in-gatsby/","category":"post"},"frontmatter":{"title":"Enable mathjax in gatsby","date":"2018-09-04T06:30:28Z","tags":["gatsby","mathjax"],"desc":"Mathjax was used in some old posts, and it can't work correctly in gastby now. "}},"next":{"internal":{"content":"---\ntitle : \"Migrate from Hugo to Gatsby\"\ndate : \"2018-08-14T10:52:17Z\"\n\n---\n\nI decided to migrate my blog from hugo to gatsby.\nGatsby is based on react and misc plugins, and it works in the same way as normal web development. \nBut there are still some works to do, such as mathjax support.\n\n\n\n\n"},"fields":{"slug":"/post/2018-08-14-migrate-from-hugo-to-gatsby/","category":"post"},"frontmatter":{"title":"Migrate from Hugo to Gatsby","date":"2018-08-14T10:52:17Z","tags":null,"desc":null}}}}