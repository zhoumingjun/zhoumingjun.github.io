{"data":{"site":{"siteMetadata":{"title":"Mingjun Zhou's blog","author":"Mingjun Zhou"}},"markdownRemark":{"id":"e50549fa-aa69-547d-9fac-daa00b9f5bf9 >>> MarkdownRemark","excerpt":"how to enable mathjax in gatsby Steps 1. Configure gatsby-config.js 2. Customize html.js Follows the  official document     Here is my  htmlâ€¦","html":"<h1>how to enable mathjax in gatsby</h1>\n<h1>Steps</h1>\n<h2>1. Configure gatsby-config.js</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// In your gatsby-config.js\nplugins: [\n  {\n    resolve: `gatsby-transformer-remark`,\n    options: {\n      plugins: [\n        `gatsby-remark-mathjax`,\n      ],\n    },\n  },\n],</code></pre></div>\n<h2>2. Customize html.js</h2>\n<p>Follows the <a href=\"https://www.gatsbyjs.org/docs/custom-html/\">official document</a>   </p>\n<p>Here is my <a href=\"https://github.com/zhoumingjun/zhoumingjun.github.io/blob/develop/src/html.js\">html.js</a></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> MathJaxConfig <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`\nMathJax.Hub.Config({\n  messageStyle: 'none',\n  showProcessingMessages: false,\n  extensions: ['[a11y]/auto-collapse.js'],\n  'auto-collapse': {\n    disabled: false\n  },\n  SVG: {\n    linebreaks: {\n      automatic: true,\n      width: 'container'\n    }\n  },\n  tex2jax: {\n    inlineMath: [ ['$','$'], ['\\\\(','\\\\)'] ],\n    processEscapes: true\n  }\n});`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HTML</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>html <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>htmlAttributes<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>meta charSet<span class=\"token operator\">=</span><span class=\"token string\">\"utf-8\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>meta httpEquiv<span class=\"token operator\">=</span><span class=\"token string\">\"x-ua-compatible\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"ie=edge\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>meta\n            name<span class=\"token operator\">=</span><span class=\"token string\">\"viewport\"</span>\n            content<span class=\"token operator\">=</span><span class=\"token string\">\"width=device-width, initial-scale=1, shrink-to-fit=no\"</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>headComponents<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>body <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>bodyAttributes<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>preBodyComponents<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>div\n            key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token string\">`body`</span></span><span class=\"token punctuation\">}</span>\n            id<span class=\"token operator\">=</span><span class=\"token string\">\"___gatsby\"</span>\n            dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>__html<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>postBodyComponents<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>script\n            type<span class=\"token operator\">=</span><span class=\"token string\">\"text/x-mathjax-config\"</span>\n            dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>__html<span class=\"token punctuation\">:</span> MathJaxConfig<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>script\n            defer\n            src<span class=\"token operator\">=</span><span class=\"token string\">\"https://cdn.bootcss.com/mathjax/2.7.4/latest.js?config=TeX-AMS_SVG\"</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token constant\">HTML</span><span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  htmlAttributes<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">,</span>\n  headComponents<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">,</span>\n  bodyAttributes<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">,</span>\n  preBodyComponents<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">,</span>\n  body<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n  postBodyComponents<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>3. Configure gatsby-browser.js</h2>\n<p>MathJax will process all math equations when the location changed.</p>\n<p>Here is my <a href=\"https://github.com/zhoumingjun/zhoumingjun.github.io/blob/develop/gatsby-browser.js\">gatsby-brower.js</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">exports.onRouteUpdate = ({location}) =&gt; {\n  console.log(&#39;new pathname&#39;, location.pathname);\n  if (window.MathJax !== undefined) {\n    MathJax.Hub.Queue([&#39;Typeset&#39;, MathJax.Hub]);\n  }\n};</code></pre></div>","fields":{"slug":"/post/2018-09-04-enable-mathjax-in-gatsby/","category":"post"},"frontmatter":{"title":"Enable mathjax in gatsby","date":"September 04, 2018"}}},"pageContext":{"slug":"/post/2018-09-04-enable-mathjax-in-gatsby/","category":"post","prev":null,"next":{"internal":{"content":"---\ntitle : \"Install cuda9.2 and cudnn7.2 on ubuntu 18.04\"\ndate : \"2018-08-23T15:01:49Z\"\n \n---\n\n# Overview\nTo run tensorflow/pytorch with gpu, I need to install cuda and cudnn.\nIt's really tricky, but finally I found the method. \n\nThe secret is   \n* install the graphics driver from a PPA \n* install the toolkit from the run file\n\n# packages\nThe following packages need to be installed.\n* nvidia graphics driver     \n* cuda 9.2  \n* cudnn 7.2\n\nFor nvidia graphics driver, there are two sources:\n1. raphics-drivers/ppa:     \nhttps://launchpad.net/~graphics-drivers/+archive/ubuntu/ppa         \nthe package is nvidia-driver-396\n\n2. nvidia official repo\nhttps://developer.download.nvidia.com/compute/cuda/repos/ubuntu1710/x86_64/cuda-drivers_396.44-1_amd64.deb  \nthe package is cuda-drivers\n\nIn fact the nvidia cuda-drivers is for ubuntu 17.10, and there are no official nvidia repo for ubuntu 18.04 currently.  \nHere we need to select option 1, I have try option2, but there are conflict with other packages.    \nI install the cuda-drivers with \"--force-overwrite\", but gdm can't be launched normally.\n\nFor cuda 9.2, it can be download directly from nvidia website.\n\nFor cudnn7.2, **it can be download from nvidia machine-learning repo without login**\n\n\n# installation steps\n\ninstall nvidia graphics driver  \n\n```bash \nsudo add-apt-repository ppa:graphics-drivers/ppa\nsudo apt update\nsudo apt-get install nvidia-driver-396\n```\n\ninstall cuda    \n\n```bash\n# dowload installer\naria2c https://developer.nvidia.com/compute/cuda/9.2/Prod2/local_installers/cuda_9.2.148_396.37_linux \n\naria2c https://developer.nvidia.com/compute/cuda/9.2/Prod2/patches/1/cuda_9.2.148.1_linux  \n\n# install cuda9.2 and patch\nchmod +x cuda*\n\nsudo ./cuda_9.2.148_396.37_linux.run --verbose --silent --toolkit --override\n\nsudo ./cuda_9.2.148.1_linux.run --silent --accept-eula\n\n# add to ld\nsudo echo \"/usr/local/cuda-9.2/lib64\" >> /etc/ld.so.conf\nsudo ldconfig\n```\n\ninstall cudnn   \n```bash\n#download packages\naria2c https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64/libcudnn7_7.2.1.38-1+cuda9.2_amd64.deb\n\naria2c https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64/libcudnn7-dev_7.2.1.38-1+cuda9.2_amd64.deb    \n\n# install\nsudo dpkg -i libcudnn7_7.2.1.38-1+cuda9.2_amd64.deb\nsudo dpkg -i libcudnn7-dev_7.2.1.38-1+cuda9.2_amd64.deb\n```\n"},"fields":{"slug":"/post/2018-08-23-install-cuda-and-cudnn-on-ubuntu18.04/","category":"post"},"frontmatter":{"title":"Install cuda9.2 and cudnn7.2 on ubuntu 18.04","date":"2018-08-23T15:01:49Z","tags":null}}}}