{"data":{"site":{"siteMetadata":{"title":"Mingjun Zhou's blog","author":"Mingjun Zhou","sourceUrl":"https://github.com/zhoumingjun/zhoumingjun.github.io/blob/source/","siteUrl":"https://zhoumingjun.github.io","disqusShortname":"zhoumingjun"}},"markdownRemark":{"id":"9e01acca-b9cd-5101-a2aa-c03bb31bc6b0 >>> MarkdownRemark","excerpt":"python3 star operator map zip lambda NDArray Indexing https://docs.scipy.org/doc/numpy/user/basics.indexing.html pytorch basic rnn Refer to…","html":"<h1>python3</h1>\n<h2>star operator</h2>\n<h2>map zip lambda</h2>\n<h2>NDArray Indexing</h2>\n<p><a href=\"https://docs.scipy.org/doc/numpy/user/basics.indexing.html\">https://docs.scipy.org/doc/numpy/user/basics.indexing.html</a></p>\n<h1>pytorch</h1>\n<h2>basic rnn</h2>\n<p>Refer to <a href=\"https://pytorch.org/docs/stable/nn.html#lstm\">https://pytorch.org/docs/stable/nn.html#lstm</a></p>\n<p>Andrej Karpathy’s diagram shows the different pattern in RNN\n<img src=\"./rnn.jpe\" alt=\"RNN\"></p>\n<p>The following code show the concept about sequence.\ntorch.nn.LSTM can handle the sequence automatically, but we can feed it step-by-step also.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> torch\n\ninput_size <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nhidden_size <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\nnum_layers <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n<span class=\"token comment\"># model</span>\nmodel <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>LSTM<span class=\"token punctuation\">(</span>input_size<span class=\"token punctuation\">,</span> hidden_size<span class=\"token punctuation\">,</span> num_layers<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># data</span>\n<span class=\"token builtin\">input</span> <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># option1: sequence</span>\noutput<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> model<span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># option2: step by step</span>\ninput_0 <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\ninput_1 <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\ninput_2 <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\ninput_3 <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n\noutput_0<span class=\"token punctuation\">,</span> hidden <span class=\"token operator\">=</span> model<span class=\"token punctuation\">(</span>input_0<span class=\"token punctuation\">)</span>\noutput_1<span class=\"token punctuation\">,</span> hidden <span class=\"token operator\">=</span> model<span class=\"token punctuation\">(</span>input_1<span class=\"token punctuation\">,</span> hidden<span class=\"token punctuation\">)</span>\noutput_2<span class=\"token punctuation\">,</span> hidden <span class=\"token operator\">=</span> model<span class=\"token punctuation\">(</span>input_2<span class=\"token punctuation\">,</span> hidden<span class=\"token punctuation\">)</span>\noutput_3<span class=\"token punctuation\">,</span> hidden <span class=\"token operator\">=</span> model<span class=\"token punctuation\">(</span>input_3 <span class=\"token punctuation\">,</span> hidden<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># compare result</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>output_0<span class=\"token punctuation\">,</span> output_1<span class=\"token punctuation\">,</span> output_2<span class=\"token punctuation\">,</span>output_3<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>output_0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> hidden_size<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>output_1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> hidden_size<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>output_2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> hidden_size<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>output_3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> hidden_size<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>pack pad</h2>\n<p><a href=\"https://djosix.github.io/Variable-Sequence-Lengths-for-PyTorch-RNNs/\">https://djosix.github.io/Variable-Sequence-Lengths-for-PyTorch-RNNs/</a></p>\n<h1>refs</h1>\n<p><a href=\"https://www.pythonlikeyoumeanit.com/intro.html\">https://www.pythonlikeyoumeanit.com/intro.html</a>\n<a href=\"https://djosix.github.io/Variable-Sequence-Lengths-for-PyTorch-RNNs/\">https://djosix.github.io/Variable-Sequence-Lengths-for-PyTorch-RNNs/</a>\n<a href=\"https://medium.com/understand-the-python/understanding-the-asterisk-of-python-8b9daaa4a558\">https://medium.com/understand-the-python/understanding-the-asterisk-of-python-8b9daaa4a558</a></p>","fileAbsolutePath":"/home/zhoumingjun/github.com/zhoumingjun/zhoumingjun.github.io/content/series/pytorch/rnn/1-Fundamental/index.md","fields":{"slug":"/series/pytorch/rnn/1-Fundamental/","category":"series"},"frontmatter":{"title":"Fundamental","date":"September 07, 2018"}}},"pageContext":{"slug":"/series/pytorch/rnn/1-Fundamental/","toc":"{\"children\":{\"rnn\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle: \\\"RNN\\\"\\ndate: \\\"2018-09-07T10:16:47Z\\\"\\ntags: [\\\"machine learning\\\",\\\"pytorch\\\", \\\"rnn\\\"]\\n---\\n\\nRNN\\n\\ntodo:\\nseq2seq:\\nhttps://www.microsoft.com/en-us/cognitive-toolkit/blog/2016/11/sequence-to-sequence-deep-recurrent-neural-networks-in-cntk-part-1/\"},\"fields\":{\"slug\":\"/series/pytorch/rnn/\",\"category\":\"series\"},\"frontmatter\":{\"title\":\"RNN\",\"date\":\"2018-09-07T10:16:47Z\",\"tags\":[\"machine learning\",\"pytorch\",\"rnn\"],\"desc\":null}},\"children\":{\"1-Fundamental\":{\"post\":{\"internal\":{\"content\":\"---\\ntitle: \\\"Fundamental\\\"\\ndate: \\\"2018-09-07T10:16:47Z\\\"\\ntags: [\\\"machine learning\\\",\\\"pytorch\\\", \\\"rnn\\\"]\\n---\\n\\n\\n# python3\\n\\n## star operator\\n\\n## map zip lambda\\n \\n## NDArray Indexing\\nhttps://docs.scipy.org/doc/numpy/user/basics.indexing.html\\n\\n\\n# pytorch\\n\\n\\n## basic rnn\\nRefer to https://pytorch.org/docs/stable/nn.html#lstm\\n\\nAndrej Karpathy’s diagram shows the different pattern in RNN\\n![RNN](./rnn.jpe)\\n\\nThe following code show the concept about sequence. \\ntorch.nn.LSTM can handle the sequence automatically, but we can feed it step-by-step also.  \\n\\n\\n```python\\nimport torch\\n\\ninput_size = 10\\nhidden_size = 20\\nnum_layers = 1\\n\\n# model\\nmodel = torch.nn.LSTM(input_size, hidden_size, num_layers)\\n\\n# data\\ninput = torch.ones(4, 1, 10)\\n\\n# option1: sequence\\noutput, _ = model(input)\\n\\n# option2: step by step\\ninput_0 = input[0,:,:].view(1,1,10)\\ninput_1 = input[1,:,:].view(1,1,10)\\ninput_2 = input[2,:,:].view(1,1,10)\\ninput_3 = input[3,:,:].view(1,1,10)\\n\\noutput_0, hidden = model(input_0)\\noutput_1, hidden = model(input_1, hidden)\\noutput_2, hidden = model(input_2, hidden)\\noutput_3, hidden = model(input_3 , hidden)\\n\\n# compare result\\nprint(output)\\nprint(output_0, output_1, output_2,output_3)\\n\\nprint ((output[0]==output_0).sum().item() == hidden_size)\\nprint ((output[1]==output_1).sum().item() == hidden_size)\\nprint ((output[2]==output_2).sum().item() == hidden_size)\\nprint ((output[3]==output_3).sum().item() == hidden_size)\\n```\\n\\n\\n## pack pad\\n\\n\\n\\nhttps://djosix.github.io/Variable-Sequence-Lengths-for-PyTorch-RNNs/\\n\\n# refs\\n\\nhttps://www.pythonlikeyoumeanit.com/intro.html\\n https://djosix.github.io/Variable-Sequence-Lengths-for-PyTorch-RNNs/\\n https://medium.com/understand-the-python/understanding-the-asterisk-of-python-8b9daaa4a558\"},\"fields\":{\"slug\":\"/series/pytorch/rnn/1-Fundamental/\",\"category\":\"series\"},\"frontmatter\":{\"title\":\"Fundamental\",\"date\":\"2018-09-07T10:16:47Z\",\"tags\":[\"machine learning\",\"pytorch\",\"rnn\"],\"desc\":null}}}}}},\"post\":{\"internal\":{\"content\":\"---\\ntitle: \\\"pytorch\\\"\\ndate: \\\"2018-09-07T10:16:47Z\\\"\\ntags: [\\\"machine learning\\\",\\\"pytorch\\\"]\\n---\\n\\nPytorch\"},\"fields\":{\"slug\":\"/series/pytorch/\",\"category\":\"series\"},\"frontmatter\":{\"title\":\"pytorch\",\"date\":\"2018-09-07T10:16:47Z\",\"tags\":[\"machine learning\",\"pytorch\"],\"desc\":null}}}","next":null,"prev":{"internal":{"content":"---\ntitle: \"RNN\"\ndate: \"2018-09-07T10:16:47Z\"\ntags: [\"machine learning\",\"pytorch\", \"rnn\"]\n---\n\nRNN\n\ntodo:\nseq2seq:\nhttps://www.microsoft.com/en-us/cognitive-toolkit/blog/2016/11/sequence-to-sequence-deep-recurrent-neural-networks-in-cntk-part-1/"},"fields":{"slug":"/series/pytorch/rnn/","category":"series"},"frontmatter":{"title":"RNN","date":"2018-09-07T10:16:47Z","tags":["machine learning","pytorch","rnn"],"desc":null}}}}