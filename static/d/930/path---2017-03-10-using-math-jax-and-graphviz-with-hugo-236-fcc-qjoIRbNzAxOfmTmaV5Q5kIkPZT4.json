{"data":{"site":{"siteMetadata":{"title":"Mingjun Zhou's blog","author":"Mingjun Zhou","sourceUrl":"https://github.com/zhoumingjun/zhoumingjun.github.io/blob/source/","siteUrl":"https://zhoumingjun.github.io","disqusShortname":"zhoumingjun"}},"markdownRemark":{"id":"05f3926c-6472-55d3-ac85-99107558d299","html":"<h1>MathJax support</h1>\n<h2>configuration</h2>\n<p><a href=\"https://gohugo.io/tutorials/mathjax/\">Hugo doc</a><br>\n<a href=\"http://docs.mathjax.org/en/latest/configuration.html?#using-plain-javascript\">MathJax doc</a>     </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;!-- LaTeX math rendering --&gt;\n{{ if  .Params.math   }}\n&lt;script type=&quot;text/javascript&quot;&gt;\n    window.MathJax = {\n        tex2jax: {\n            inlineMath: [[&#39;$&#39;,&#39;$&#39;], [&#39;\\\\(&#39;,&#39;\\\\)&#39;]],\n            displayMath: [[&#39;$$&#39;,&#39;$$&#39;], [&#39;\\[&#39;,&#39;\\]&#39;]],\n            processEscapes: true,\n            processEnvironments: true,\n            skipTags: [&#39;script&#39;, &#39;noscript&#39;, &#39;style&#39;, &#39;textarea&#39;, &#39;pre&#39;],\n            TeX: { equationNumbers: { autoNumber: &quot;AMS&quot; },\n                extensions: [&quot;AMSmath.js&quot;, &quot;AMSsymbols.js&quot;, &quot;color.js&quot;] }\n        },\n        AuthorInit: function () {\n            MathJax.Hub.Register.StartupHook(&quot;Begin&quot;,function () {\n                MathJax.Hub.Queue(function() {\n                    var all = MathJax.Hub.getAllJax(), i;\n                    for(i = 0; i &lt; all.length; i += 1) {\n                        all[i].SourceElement().parentNode.className += &#39; has-jax&#39;;\n                    }\n                })\n            });\n        }\n    };\n&lt;/script&gt;\n&lt;script  type=&quot;text/javascript&quot;\n    src=&quot;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML&quot;&gt;\n&lt;/script&gt;\n{{ end }}</code></pre></div>\n<h2>example</h2>\n<p><strong>code</strong>    </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    $ v_\\pi(s) = \\sum_{a \\in \\mathcal{A}} \\pi(a|s) q_\\pi(s,a)  $</code></pre></div>\n<p><strong>result</strong><br>\n$v_\\pi(s) = \\sum_{a \\in \\mathcal{A}} \\pi(a|s) q_\\pi(s,a)$</p>\n<h1>graphviz support</h1>\n<h2>configuration</h2>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- graphviz renderring --></span>\n{{ if  .Params.viz}}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>//cdnjs.cloudflare.com/ajax/libs/viz.js/1.7.1/viz.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\"> </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\">\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> vizPrefix <span class=\"token operator\">=</span> <span class=\"token string\">\"language-viz-\"</span><span class=\"token punctuation\">;</span>\n    Array<span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>forEach<span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[class^=\"</span> <span class=\"token operator\">+</span> vizPrefix <span class=\"token operator\">+</span> <span class=\"token string\">\"]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> engine<span class=\"token punctuation\">;</span>\n        x<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"class\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span>vizPrefix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                engine <span class=\"token operator\">=</span> cls<span class=\"token punctuation\">.</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span>vizPrefix<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> image <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DOMParser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseFromString</span><span class=\"token punctuation\">(</span><span class=\"token function\">Viz</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>format<span class=\"token punctuation\">:</span><span class=\"token string\">\"svg\"</span><span class=\"token punctuation\">,</span> engine<span class=\"token punctuation\">:</span>engine<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"image/svg+xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        x<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        x<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'none'</span>\n        x<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n{{ end }}</code></pre></div>\n<h2>example</h2>\n<p><strong>code</strong>        </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    ```viz-dot\n    digraph g { \n    node[shape=&quot;circle&quot; , label=&quot;&quot;, width=0.2, height=0.2]\n    l1[xlabel=&quot;v\\(s\\)&quot;]\n    l21[xlabel=&quot;a&quot;, width=0.1, height=0.1 , style=filled]\n    l22[width=0.1, height=0.1, style=filled]\n    l31[xlabel=&quot;v\\(s&#39;\\)&quot;]\n\n    l1 -&gt; l21\n    l1 -&gt; l22\n    l21 -&gt; l31 [xlabel=&quot;r&quot;]\n    l21 -&gt; l32\n    l22 -&gt; l33\n    l22 -&gt; l34\n    }\n    ```</code></pre></div>\n<p><strong>result</strong>   </p>\n<div class=\"gatsby-highlight\" data-language=\"viz-dot\"><pre class=\"language-viz-dot\"><code class=\"language-viz-dot\">digraph g { \n   node[shape=&quot;circle&quot; , label=&quot;&quot;, width=0.2, height=0.2]\n   l1[xlabel=&quot;v\\(s\\)&quot;]\n   l21[xlabel=&quot;a&quot;, width=0.1, height=0.1 , style=filled]\n   l22[width=0.1, height=0.1, style=filled]\n   l31[xlabel=&quot;v\\(s&#39;\\)&quot;]\n\n   l1 -&gt; l21\n   l1 -&gt; l22\n   l21 -&gt; l31 [xlabel=&quot;r&quot;]\n   l21 -&gt; l32\n   l22 -&gt; l33\n   l22 -&gt; l34\n}</code></pre></div>","fileAbsolutePath":"/home/zhoumingjun/github.com/zhoumingjun/zhoumingjun.github.io/content/post/2017-03-10-using-mathjax-viz-with-hugo/index.md","fields":{"permalink":"/2017/03/10/Using-MathJax-and-Graphviz-with-Hugo","category":"post"},"frontmatter":{"title":"Using MathJax and Graphviz with Hugo","date":"March 10, 2017"}}},"pageContext":{"permalink":"/2017/03/10/Using-MathJax-and-Graphviz-with-Hugo","prev":{"internal":{"content":"\n# introduction\n- lvs:      \n  [lvs](http://www.linuxvirtualserver.org/) is a kind of L4 load balancer.              \n  some references here:\n  [howto] (http://www.austintek.com/LVS/LVS-HOWTO/HOWTO/index.html)\n\n  \n- keepalived:       \n  [keepalived](http://www.keepalived.org/) is a facilitator for lvs\n\n# configuration\n\ntopology:\n\n- DIP: 192.168.2.172            \n- RIP[1]: 192.168.2.173         \n- RIP[2]: 192.168.2.174     \n- VIP: 192.168.2.175            \n\n## lvs only\ndirector side \n```\n#install ipvsadm\nyum -y install ipvsadm\necho 'net.ipv4.ip_forward = 1' >> /etc/sysctl.conf \nsysctl -p\ntouch /etc/sysconfig/ipvsadm \nsystemctl start ipvsadm \nsystemctl enable ipvsadm \n\n# add vip\nifconfig em1:0 192.168.2.175 netmask 255.255.255.255\n\n# configuration\nipvsadm -C\nipvsadm -A -t 192.168.2,175:80 -s rr\nipvsadm -a -t 192.168.2,175:80 -r 192.168.2,173:80 -g\nipvsadm -a -t 192.168.2,175:80 -r 192.168.2,174:80 -g\nipvsadm -l \n```\n\nrealserver side\n```\n# add vip\nifconfig lo:0 192.168.2.175 netmask 255.255.255.255 broadcast 192.168.2.175 \n\n# disable VIP arp\necho \"1\" > /proc/sys/net/ipv4/conf/lo/arp_ignore\necho \"2\" > /proc/sys/net/ipv4/conf/lo/arp_announce\necho \"1\" > /proc/sys/net/ipv4/conf/all/arp_ignore\necho \"2\" > /proc/sys/net/ipv4/conf/all/arp_announce\n```\n\n## lvs + keepalived\ndirector side \n\n```\nglobal_defs {              \n    router_id LVS_MASTER   \n}\nvrrp_instance VI_1 {       \n    state MASTER           \n    interface em1          \n    virtual_router_id 51   \n    priority 100           \n    advert_int 1           \n    authentication {       \n    auth_type PASS\n    auth_pass 1111\n    }\nvirtual_ipaddress {        \n    192.168.2.175\n    }\n}\nvirtual_server 192.168.2.175 80 {\n    delay_loop 6            \n    lb_algo wrr             \n    lb_kind DR              \n    nat_mask 255.255.255.0  \n    #persistence_timeout 5  \n    protocol TCP            \n    real_server 192.168.2.173 80 {      \n        weight 3                   \n        TCP_CHECK {               \n        connect_timeout 5        \n        nb_get_retry 3\n        delay_before_retry 3\n        connect_port 80\n        }\n    }\n    real_server 192.168.2.174 80 {\n        weight 3\n        TCP_CHECK {\n        connect_timeout 10\n        nb_get_retry 3\n        delay_before_retry 3\n        connect_port 80\n        }\n    }\n}\n```\n\nrealserver side\n```\n# add vip\nifconfig lo:0 192.168.2.175 netmask 255.255.255.255 broadcast 192.168.2.175 \n\n# disable VIP arp\necho \"1\" > /proc/sys/net/ipv4/conf/lo/arp_ignore\necho \"2\" > /proc/sys/net/ipv4/conf/lo/arp_announce\necho \"1\" > /proc/sys/net/ipv4/conf/all/arp_ignore\necho \"2\" > /proc/sys/net/ipv4/conf/all/arp_announce\n```"},"fields":{"fpath":"/post/2017-03-22-lvs-keepalived/","permalink":"/2017/03/22/lvs-keepalived","category":"post"},"frontmatter":{"title":"lvs keepalived","date":"2017-03-22","tags":["lvs"],"desc":null,"slug":null}},"next":{"internal":{"content":"\nI build this site to boost my daily work. \n\nThis website is powered by [Academic](https://github.com/gcushen/hugo-academic), [Hugo](https://gohugo.io), and [GitHub Pages](https://github.com/).   \n\n\n\n"},"fields":{"fpath":"/post/2017-03-06-first-post/","permalink":"/2017/03/06/First-Post","category":"post"},"frontmatter":{"title":"First Post","date":"2017-03-06","tags":null,"desc":null,"slug":null}}}}