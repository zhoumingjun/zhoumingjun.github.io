<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-styled-components="cAgbtO cwBHYZ iowhYu jYyoao jNdvGQ XCWMt dcHpVA aUlIN bBMZdm bAkQbM jsmUBO kqOaZP fNWKbM geNrKo lhngOP bgTSvM cqucDl dNqXDt kxIxwt htiNkm lkhcfi fWUEzy jYdOyG cuXUhH gAPxCU cHcjia koqsCN diFVLO eYnoOi">
/* sc-component-id: StyledBox-YaZNy */
.dNqXDt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:#FFA500;color:#444444;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;grid-area:header;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin:0;padding:12px;opacity:0;-webkit-animation:dHUfhi 1s 0s forwards;animation:dHUfhi 1s 0s forwards;} @media only screen and (max-width:699px){.dNqXDt{margin:0;}} @media only screen and (max-width:699px){.dNqXDt{padding:6px;}}.kxIxwt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;width:1152px;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:0;padding:0;} @media only screen and (max-width:699px){.kxIxwt{margin:0;}} @media only screen and (max-width:699px){.kxIxwt{padding:0;}}.htiNkm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin:0;padding:0;} @media only screen and (max-width:699px){.htiNkm{margin:0;}} @media only screen and (max-width:699px){.htiNkm{padding:0;}}.lkhcfi{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;grid-area:main;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin:0;padding:0;} @media only screen and (max-width:699px){.lkhcfi{margin:0;}} @media only screen and (max-width:699px){.lkhcfi{padding:0;}}.fWUEzy{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;width:1152px;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:0;padding:0;} @media only screen and (max-width:699px){.fWUEzy{margin:0;}} @media only screen and (max-width:699px){.fWUEzy{padding:0;}}
/* sc-component-id: StyledBox__StyledBoxGap-eHDBek */
.koqsCN{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;width:24px;}
/* sc-component-id: StyledText-dmaDlZ */
.jYdOyG{font-size:22px;line-height:28px;}.cuXUhH{font-size:18px;line-height:24px;}
/* sc-component-id: StyledAnchor-bymPHU */
.gAPxCU{box-sizing:border-box;font-size:inherit;line-height:inherit;color:#6194EB;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;outline:none;} .gAPxCU:hover{-webkit-text-decoration:underline;text-decoration:underline;}
/* sc-component-id: sc-keyframes-cAgbtO */
@-webkit-keyframes cAgbtO{0%{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}100%{-webkit-transform:translateY(-100%);-ms-transform:translateY(-100%);transform:translateY(-100%);}} @keyframes cAgbtO{0%{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}100%{-webkit-transform:translateY(-100%);-ms-transform:translateY(-100%);transform:translateY(-100%);}}
/* sc-component-id: sc-keyframes-cwBHYZ */
@-webkit-keyframes cwBHYZ{0%{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}100%{-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);}} @keyframes cwBHYZ{0%{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}100%{-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);}}
/* sc-component-id: sc-keyframes-iowhYu */
@-webkit-keyframes iowhYu{0%{-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);}100%{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}} @keyframes iowhYu{0%{-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);}100%{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}}
/* sc-component-id: sc-keyframes-jYyoao */
@-webkit-keyframes jYyoao{0%{-webkit-transform:translateY(-100%);-ms-transform:translateY(-100%);transform:translateY(-100%);}100%{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}} @keyframes jYyoao{0%{-webkit-transform:translateY(-100%);-ms-transform:translateY(-100%);transform:translateY(-100%);}100%{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}}
/* sc-component-id: sc-keyframes-jNdvGQ */
@-webkit-keyframes jNdvGQ{0%{opacity:0.5;-webkit-transform:scale(0.8);-ms-transform:scale(0.8);transform:scale(0.8);}100%{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}} @keyframes jNdvGQ{0%{opacity:0.5;-webkit-transform:scale(0.8);-ms-transform:scale(0.8);transform:scale(0.8);}100%{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}}
/* sc-component-id: StyledGrid-csYDyF */
.cqucDl{display:grid;box-sizing:border-box;grid-template-areas:"header" "main";grid-template-columns:100%;grid-template-rows:auto 1fr;}
/* sc-component-id: StyledGrommet-gKbdxL */
@font-face{font-family:'Fira Sans';font-style:normal;font-weight:400;src:local('Fira Sans Regular'),local('FiraSans-Regular'),url(https://fonts.gstatic.com/s/firasans/v8/va9E4kDNxMZdWfMOD5VvmojLazX3dGTP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;} @font-face{font-family:'Fira Sans';font-style:normal;font-weight:400;src:local('Fira Sans Regular'),local('FiraSans-Regular'),url(https://fonts.gstatic.com/s/firasans/v8/va9E4kDNxMZdWfMOD5Vvk4jLazX3dGTP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;} @font-face{font-family:'Fira Sans';font-style:normal;font-weight:400;src:local('Fira Sans Regular'),local('FiraSans-Regular'),url(https://fonts.gstatic.com/s/firasans/v8/va9E4kDNxMZdWfMOD5Vvm4jLazX3dGTP.woff2) format('woff2');unicode-range:U+1F00-1FFF;} @font-face{font-family:'Fira Sans';font-style:normal;font-weight:400;src:local('Fira Sans Regular'),local('FiraSans-Regular'),url(https://fonts.gstatic.com/s/firasans/v8/va9E4kDNxMZdWfMOD5VvlIjLazX3dGTP.woff2) format('woff2');unicode-range:U+0370-03FF;} @font-face{font-family:'Fira Sans';font-style:normal;font-weight:400;src:local('Fira Sans Regular'),local('FiraSans-Regular'),url(https://fonts.gstatic.com/s/firasans/v8/va9E4kDNxMZdWfMOD5VvmIjLazX3dGTP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+1EA0-1EF9,U+20AB;} @font-face{font-family:'Fira Sans';font-style:normal;font-weight:400;src:local('Fira Sans Regular'),local('FiraSans-Regular'),url(https://fonts.gstatic.com/s/firasans/v8/va9E4kDNxMZdWfMOD5VvmYjLazX3dGTP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;} @font-face{font-family:'Fira Sans';font-style:normal;font-weight:400;src:local('Fira Sans Regular'),local('FiraSans-Regular'),url(https://fonts.gstatic.com/s/firasans/v8/va9E4kDNxMZdWfMOD5Vvl4jLazX3dA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;} .bgTSvM{font-family:'Fira Sans',Arial,sans-serif;font-size:18px;line-height:24px;color:#444444;box-sizing:border-box;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;}
/* sc-component-id: sc-keyframes-XCWMt */
@-webkit-keyframes XCWMt{0%{-webkit-transform:translateX(-50%) scale(0.8);-ms-transform:translateX(-50%) scale(0.8);transform:translateX(-50%) scale(0.8);}100%{-webkit-transform:translateX(-50%) scale(1);-ms-transform:translateX(-50%) scale(1);transform:translateX(-50%) scale(1);}} @keyframes XCWMt{0%{-webkit-transform:translateX(-50%) scale(0.8);-ms-transform:translateX(-50%) scale(0.8);transform:translateX(-50%) scale(0.8);}100%{-webkit-transform:translateX(-50%) scale(1);-ms-transform:translateX(-50%) scale(1);transform:translateX(-50%) scale(1);}}
/* sc-component-id: sc-keyframes-dcHpVA */
@-webkit-keyframes dcHpVA{0%{-webkit-transform:translateY(-50%) scale(0.8);-ms-transform:translateY(-50%) scale(0.8);transform:translateY(-50%) scale(0.8);}100%{-webkit-transform:translateY(-50) scale(1);-ms-transform:translateY(-50) scale(1);transform:translateY(-50) scale(1);}} @keyframes dcHpVA{0%{-webkit-transform:translateY(-50%) scale(0.8);-ms-transform:translateY(-50%) scale(0.8);transform:translateY(-50%) scale(0.8);}100%{-webkit-transform:translateY(-50) scale(1);-ms-transform:translateY(-50) scale(1);transform:translateY(-50) scale(1);}}
/* sc-component-id: sc-keyframes-aUlIN */
@-webkit-keyframes aUlIN{0%{-webkit-transform:scale(0.8);-ms-transform:scale(0.8);transform:scale(0.8);}100%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}} @keyframes aUlIN{0%{-webkit-transform:scale(0.8);-ms-transform:scale(0.8);transform:scale(0.8);}100%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}}
/* sc-component-id: sc-keyframes-bBMZdm */
@-webkit-keyframes bBMZdm{0%{-webkit-transform:translate(-50%,-50%) scale(0.8);-ms-transform:translate(-50%,-50%) scale(0.8);transform:translate(-50%,-50%) scale(0.8);}100%{-webkit-transform:translate(-50%,-50%) scale(1);-ms-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1);}} @keyframes bBMZdm{0%{-webkit-transform:translate(-50%,-50%) scale(0.8);-ms-transform:translate(-50%,-50%) scale(0.8);transform:translate(-50%,-50%) scale(0.8);}100%{-webkit-transform:translate(-50%,-50%) scale(1);-ms-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1);}}
/* sc-component-id: sc-keyframes-bAkQbM */
@-webkit-keyframes bAkQbM{0%{-webkit-transform:translate(-50%,-100%);-ms-transform:translate(-50%,-100%);transform:translate(-50%,-100%);}100%{-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);transform:translate(-50%,0);}} @keyframes bAkQbM{0%{-webkit-transform:translate(-50%,-100%);-ms-transform:translate(-50%,-100%);transform:translate(-50%,-100%);}100%{-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);transform:translate(-50%,0);}}
/* sc-component-id: sc-keyframes-jsmUBO */
@-webkit-keyframes jsmUBO{0%{-webkit-transform:translate(-50%,100%);-ms-transform:translate(-50%,100%);transform:translate(-50%,100%);}100%{-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);transform:translate(-50%,0);}} @keyframes jsmUBO{0%{-webkit-transform:translate(-50%,100%);-ms-transform:translate(-50%,100%);transform:translate(-50%,100%);}100%{-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);transform:translate(-50%,0);}}
/* sc-component-id: sc-keyframes-kqOaZP */
@-webkit-keyframes kqOaZP{0%{-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}100%{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);}} @keyframes kqOaZP{0%{-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}100%{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);}}
/* sc-component-id: sc-keyframes-fNWKbM */
@-webkit-keyframes fNWKbM{0%{-webkit-transform:translate(-100%,-50%);-ms-transform:translate(-100%,-50%);transform:translate(-100%,-50%);}100%{-webkit-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);}} @keyframes fNWKbM{0%{-webkit-transform:translate(-100%,-50%);-ms-transform:translate(-100%,-50%);transform:translate(-100%,-50%);}100%{-webkit-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);}}
/* sc-component-id: sc-keyframes-geNrKo */
@-webkit-keyframes geNrKo{0%{-webkit-transform:translateX(100%);-ms-transform:translateX(100%);transform:translateX(100%);}100%{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);}} @keyframes geNrKo{0%{-webkit-transform:translateX(100%);-ms-transform:translateX(100%);transform:translateX(100%);}100%{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);}}
/* sc-component-id: sc-keyframes-lhngOP */
@-webkit-keyframes lhngOP{0%{-webkit-transform:translate(100%,-50%);-ms-transform:translate(100%,-50%);transform:translate(100%,-50%);}100%{-webkit-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);}} @keyframes lhngOP{0%{-webkit-transform:translate(100%,-50%);-ms-transform:translate(100%,-50%);transform:translate(100%,-50%);}100%{-webkit-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);}}
/* sc-component-id: StyledParagraph-gnpZsU */
.eYnoOi{font-size:18px;line-height:24px;max-width:432px;}
/* sc-component-id: sc-global-2034793777 */
body{margin:0;}
/* sc-component-id: StyledBox-hownzw */
.cHcjia{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;outline:none;max-width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin:0;padding:0;} @media only screen and (max-width:699px){.cHcjia{margin:0;}} @media only screen and (max-width:699px){.cHcjia{padding:0;}}
/* sc-component-id: StyledHeading-klHxZj */
.diFVLO{font-size:50px;line-height:56px;max-width:1200px;font-weight:600;} @media only screen and (max-width:699px){.diFVLO{font-size:34px;line-height:40px;max-width:816px;font-weight:600;}}</style><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><title data-react-helmet="true">lvs keepalived | zhoumingjun blog</title><meta data-react-helmet="true" charSet="utf-8"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta data-react-helmet="true" name="HandheldFriendly" content="True"/><meta data-react-helmet="true" name="description" content="introduction lvs: lvs  is a kind of L4 load balancer. some references here:
 howto  ( http://www.austintek.com/LVS/LVS-HOWTO/HOWTO/index…"/><link as="script" rel="preload" href="/0-b4f8724d67807c66f69b.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-601d4e1aa04726c4a836.js"/><link as="script" rel="preload" href="/app-f90730dffb857dfddab6.js"/><link as="script" rel="preload" href="/webpack-runtime-ca6fbd80f6a56ef7a076.js"/><link rel="preload" href="/static/d/918/path---blog-2017-03-22-lvs-keepalived-5-c-6-865-YWzwCA4boahEyV8wCoqS15xU6NM.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="StyledGrommet-gKbdxL bgTSvM"><div class="StyledGrid-csYDyF cqucDl"><div class="StyledBox-YaZNy dNqXDt"><div class="StyledBox-YaZNy kxIxwt" width="xlarge"><span class="StyledText-dmaDlZ jYdOyG">Mingjun Zhou&#x27;s Dev Stacks</span><div class="StyledBox-YaZNy htiNkm"><a class="StyledAnchor-bymPHU gAPxCU" label="home" href="/"><span class="StyledBox-hownzw cHcjia" style="display:inline-flex"><span class="StyledText-dmaDlZ cuXUhH"><strong>home</strong></span></span></a><div class="StyledBox__StyledBoxGap-eHDBek koqsCN"></div><a class="StyledAnchor-bymPHU gAPxCU" label="blog" href="/blog"><span class="StyledBox-hownzw cHcjia" style="display:inline-flex"><span class="StyledText-dmaDlZ cuXUhH"><strong>blog</strong></span></span></a><div class="StyledBox__StyledBoxGap-eHDBek koqsCN"></div><a class="StyledAnchor-bymPHU gAPxCU" label="about" href="/about"><span class="StyledBox-hownzw cHcjia" style="display:inline-flex"><span class="StyledText-dmaDlZ cuXUhH"><strong>about</strong></span></span></a></div></div></div><div class="StyledBox-YaZNy lkhcfi"><div class="StyledBox-YaZNy fWUEzy" width="xlarge"><h1 class="StyledHeading-klHxZj diFVLO">lvs keepalived</h1><p class="StyledParagraph-gnpZsU eYnoOi">March 22, 2017</p><div><h1>introduction</h1>
<ul>
<li>
<p>lvs:<br>
<a href="http://www.linuxvirtualserver.org/">lvs</a> is a kind of L4 load balancer.<br>
some references here:
[howto] (<a href="http://www.austintek.com/LVS/LVS-HOWTO/HOWTO/index.html">http://www.austintek.com/LVS/LVS-HOWTO/HOWTO/index.html</a>)</p>
</li>
<li>
<p>keepalived:<br>
<a href="http://www.keepalived.org/">keepalived</a> is a facilitator for lvs</p>
</li>
</ul>
<h1>configuration</h1>
<p>topology:</p>
<ul>
<li>DIP: 192.168.2.172            </li>
<li>RIP[1]: 192.168.2.173         </li>
<li>RIP[2]: 192.168.2.174     </li>
<li>VIP: 192.168.2.175            </li>
</ul>
<h2>lvs only</h2>
<p>director side </p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">#install ipvsadm
yum -y install ipvsadm
echo &#39;net.ipv4.ip_forward = 1&#39; &gt;&gt; /etc/sysctl.conf 
sysctl -p
touch /etc/sysconfig/ipvsadm 
systemctl start ipvsadm 
systemctl enable ipvsadm 

# add vip
ifconfig em1:0 192.168.2.175 netmask 255.255.255.255

# configuration
ipvsadm -C
ipvsadm -A -t 192.168.2,175:80 -s rr
ipvsadm -a -t 192.168.2,175:80 -r 192.168.2,173:80 -g
ipvsadm -a -t 192.168.2,175:80 -r 192.168.2,174:80 -g
ipvsadm -l </code></pre></div>
<p>realserver side</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># add vip
ifconfig lo:0 192.168.2.175 netmask 255.255.255.255 broadcast 192.168.2.175 

# disable VIP arp
echo &quot;1&quot; &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore
echo &quot;2&quot; &gt; /proc/sys/net/ipv4/conf/lo/arp_announce
echo &quot;1&quot; &gt; /proc/sys/net/ipv4/conf/all/arp_ignore
echo &quot;2&quot; &gt; /proc/sys/net/ipv4/conf/all/arp_announce</code></pre></div>
<h2>lvs + keepalived</h2>
<p>director side </p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">global_defs {              
    router_id LVS_MASTER   
}
vrrp_instance VI_1 {       
    state MASTER           
    interface em1          
    virtual_router_id 51   
    priority 100           
    advert_int 1           
    authentication {       
    auth_type PASS
    auth_pass 1111
    }
virtual_ipaddress {        
    192.168.2.175
    }
}
virtual_server 192.168.2.175 80 {
    delay_loop 6            
    lb_algo wrr             
    lb_kind DR              
    nat_mask 255.255.255.0  
    #persistence_timeout 5  
    protocol TCP            
    real_server 192.168.2.173 80 {      
        weight 3                   
        TCP_CHECK {               
        connect_timeout 5        
        nb_get_retry 3
        delay_before_retry 3
        connect_port 80
        }
    }
    real_server 192.168.2.174 80 {
        weight 3
        TCP_CHECK {
        connect_timeout 10
        nb_get_retry 3
        delay_before_retry 3
        connect_port 80
        }
    }
}</code></pre></div>
<p>realserver side</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># add vip
ifconfig lo:0 192.168.2.175 netmask 255.255.255.255 broadcast 192.168.2.175 

# disable VIP arp
echo &quot;1&quot; &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore
echo &quot;2&quot; &gt; /proc/sys/net/ipv4/conf/lo/arp_announce
echo &quot;1&quot; &gt; /proc/sys/net/ipv4/conf/all/arp_ignore
echo &quot;2&quot; &gt; /proc/sys/net/ipv4/conf/all/arp_announce</code></pre></div></div><hr style="margin-bottom:1px"/><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blog/2017-03-10-using-mathjax-viz-with-hugo/">← <!-- -->Using MathJax and Graphviz with Hugo</a></li><li><a rel="next" href="/about/">About<!-- --> →</a></li></ul></div></div></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto');
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"blog-2017-03-22-lvs-keepalived-5c6","path":"/blog/2017-03-22-lvs-keepalived/"};window.dataPath="918/path---blog-2017-03-22-lvs-keepalived-5-c-6-865-YWzwCA4boahEyV8wCoqS15xU6NM";/*]]>*/</script><script src="/webpack-runtime-ca6fbd80f6a56ef7a076.js" async=""></script><script src="/app-f90730dffb857dfddab6.js" async=""></script><script src="/component---src-templates-blog-post-js-601d4e1aa04726c4a836.js" async=""></script><script src="/0-b4f8724d67807c66f69b.js" async=""></script></body></html>